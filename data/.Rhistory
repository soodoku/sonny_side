2+2
install.packages(tidyverse)
install.packages("tidyverse")
2+2
require(tidyverse)
install.packages("rvest")
library(rvest)
url <- "https://www.reddit.com/r/politics/comments/a1j9xs/partisan_election_officials_are_inherently_unfair/"
reddit_pg <- read_html(url)
url <- "https://www.reddit.com/r/politics/comments/a1j9xs/partisan_election_officials_are_inherently_unfair/"
reddit_pg <- read_html(url)
reddit_pg %>%
html_node("title")
reddit_pg %>%
html_node("title") %>%
html_text()
reddit_pg %>%
html_nodes("p.s90z9tc-10") %>%
html_text()
reddit_pg %>%
html_nodes("p._1qeIAgB0cPwnLhDF9XSiJM") %>%
html_text()
library(stringr)
library(rvest)
library(stringr)
library(rvest)
# Alaska AK
base_url <- "https://www.commerce.alaska.gov/cbp/main/Search/EntitiesResults?EntityName=son&IsStartsWithSearch=False&CurrentOnly=False&&pageNumber=4"
webpage <- read_html(base_url)
entities <- html_nodes(webpage, "td:nth-child(3)")
(entities <- as.character(html_text(entities)))
base_url <- "https://www.commerce.alaska.gov/cbp/main/Search/EntitiesResults?EntityName=son&IsStartsWithSearch=False&CurrentOnly=False&&pageNumber=4"
webpage <- read_html(base_url)
entities <- html_nodes(webpage, "td:nth-child(3)")
(entities <- as.character(html_text(entities)))
base_url <- "https://www.commerce.alaska.gov/cbp/main/Search/EntitiesResults?EntityName=son&IsStartsWithSearch=False&CurrentOnly=False&&pageNumber=1"
webpage <- read_html(base_url)
entities <- html_nodes(webpage, "td:nth-child(3)")
(entities <- as.character(html_text(entities)))
# Alaska AK
base_url <- "https://www.commerce.alaska.gov/cbp/main/Search/EntitiesResults?EntityName=son&IsStartsWithSearch=False&CurrentOnly=False&&pageNumber=1"
base_url
webpage <- read_html(base_url)
webpage
entities <- html_nodes(webpage, "td:nth-child(3)")
entities
webpage
base_url <- "http://www.commerce.alaska.gov/cbp/main/Search/EntitiesResults?EntityName=son&IsStartsWithSearch=False&CurrentOnly=False&&pageNumber=1"
webpage <- read_html(base_url)
entities <- html_nodes(webpage, "td:nth-child(3)")
(entities <- as.character(html_text(entities)))
base_url <- "https://www.commerce.alaska.gov/cbp/main/Search/EntitiesResults?EntityName=son&IsStartsWithSearch=False&CurrentOnly=False&&pageNumber=1"
webpage <- read_html(base_url)
entities <- html_nodes(webpage, "td:nth-child(3)")
(entities <- as.character(html_text(entities)))
base_url <- "https://www.commerce.alaska.gov/cbp/main/Search/EntitiesResults?EntityName=son&IsStartsWithSearch=False&CurrentOnly=False&&pageNumber=1"
webpage <- read_html(base_url)
entities <- html_nodes(webpage, ".deptGridView a")
(entities <- as.character(html_text(entities)))
# Alaska AK
base_url <- "https://www.commerce.alaska.gov/cbp/main/Search/EntitiesResults?EntityName=son&IsStartsWithSearch=False&CurrentOnly=False&&pageNumber=1"
base_url <- "https://www.commerce.alaska.gov/cbp/main/Search/EntitiesResults?EntityName=son&IsStartsWithSearch=False&CurrentOnly=False&&pageNumber=1"
webpage <- read_html(base_url)
entities <- html_nodes(webpage, "td:nth-child(3)")
(entities <- as.character(html_text(entities)))
?html_text
html_text(entities)
# Alaska AK
base_url <- "https://www.commerce.alaska.gov/cbp/main/Search/EntitiesResults?EntityName=son&IsStartsWithSearch=False&CurrentOnly=False&&pageNumber=1"
webpage <- read_html(base_url)
entities <- html_nodes(webpage, "td:nth-child(3)")
html_text(entities)
# Alaska AK
base_url <- "https://www.commerce.alaska.gov/cbp/main/Search/EntitiesResults?EntityName=son&IsStartsWithSearch=False&CurrentOnly=False&&pageNumber=1"
webpage <- read_html(base_url)
entities <- html_nodes(webpage, "td:nth-child(3)")
entities
webpage
u <-'http://myanimelist.net/anime/25731/Cross_Ange:_Tenshi_to_Ryuu_no_Rondo/stats'
a <- html(u)
b <- (html_nodes(a,"#content table")) %>% html_table(fill = T)
colnames(b[[4]]) <- b[[4]][1,] %>% unlist %>% as.character
b[[4]] <- b[[4]][2:nrow(b[[4]]),]
head(b[[4]])
html_text(entities)
# Alaska AK
base_url <- "https://www.commerce.alaska.gov/cbp/main/Search/EntitiesResults?EntityName=son&IsStartsWithSearch=False&CurrentOnly=False&&pageNumber=1"
webpage <- read_html(base_url)
entities <- html_nodes(webpage, "td:nth-child(3)")
entities
webpage
webpage$doc
webpage$node
setwd("C:\\Users\\wguil\\OneDrive\\Documents\\GitHub\\sonny_side\\data")
# Load libs
library(readr)
library(stringr)
library(rvest)
setwd("C:\\Users\\wguil\\OneDrive\\Documents\\GitHub\\sonny_side\\data")
# Load libs
library(readr)
library(stringr)
library(rvest)
# Alaska AK
# rvest didn't work so Gaurav did selenium pull
ak_son <- read.csv("./ak/ak-son.csv", stringsAsFactors = FALSE)
ak_daughter <- read.csv("./ak/ak-daughter.csv", stringsAsFactors = FALSE)
View(ak_son)
# Alaska AK
# rvest didn't work so Gaurav did selenium pull
ak_son <- read.csv("./ak/ak-son.csv", stringsAsFactors = FALSE)
ak_son_dedup <- ak_son[!duplicated(ak_son$Entity.Name),]
ak_son$Entity.Name
ak_son$Entity.Name[sapply(lapply(str_extract_all(tolower(ak_son$Entity.Name), "\\w+"), function(x) str_detect(x, "^son$|^sons$")), sum) > 0]
ak_son$Entity.Name[sapply(lapply(str_extract_all(tolower(ak_son$Entity.Name), "\\w+"), function(x) str_detect(x, "^son$|^sons$")), sum) == 0]
ak_son$Entity.Name[sapply(lapply(str_extract_all(tolower(ak_son$Entity.Name), "\\w+"), function(x) str_detect(x, "^son$|^sons$")), sum) > 0]
ak_daughter <- read.csv("./ak/ak-daughter.csv", stringsAsFactors = FALSE)
ak_daughter_dedup <- ak_daughter[!duplicated(ak_daughter$Entity.Name),]
ak_daughter$Entity.Name[sapply(lapply(str_extract_all(tolower(ak_daughter$Entity.Name), "\\w+"), function(x) str_detect(x, "^daughter$|^daughters$")), sum) > 0]
ak_daughter$Entity.Name[sapply(lapply(str_extract_all(tolower(ak_daughter$Entity.Name), "\\w+"), function(x) str_detect(x, "^daughter$|^daughters$")), sum) == 0]
ak_daughter$Entity.Name[sapply(lapply(str_extract_all(tolower(ak_daughter$Entity.Name), "\\w+"), function(x) str_detect(x, "^daughter$|^daughters$")), sum) > 0]
246/22
# Georgia
# Gaurav did selenium and I am pulling csv from 7z file
ga_dat <- read.csv("./ga/ga_son.csv", stringsAsFactors = FALSE)
View(ga_dat)
ga_dat_dedup <- ga_dat[!duplicated(ga_dat$Business.Name),]
ga_dat$Business.Name[sapply(lapply(str_extract_all(tolower(ga_dat$Business.Name), "\\w+"), function(x) str_detect(x, "^daughters$|^daughter$")), sum) > 0]
ga_dat$Business.Name[sapply(lapply(str_extract_all(tolower(ga_dat$Business.Name), "\\w+"), function(x) str_detect(x, "^sons$|^son$")), sum) > 0]
length(ga_dat$Business.Name[sapply(lapply(str_extract_all(tolower(ga_dat$Business.Name), "\\w+"), function(x) str_detect(x, "^sons$|^son$")), sum) > 0])
ga_dat$Business.Name[sapply(lapply(str_extract_all(tolower(ga_dat$Business.Name), "\\w+"), function(x) str_detect(x, "^sons$|^son$")), sum) > 0]
ga_dat$Business.Name[sapply(lapply(str_extract_all(tolower(ga_dat$Business.Name), "\\w+"), function(x) str_detect(x, "^daughters$|^daughter$")), sum) > 0]
6002/74
# Illinois
il_dat <- read.csv("./il/il_son.csv", stringsAsFactors = FALSE)
View(il_dat)
View(il_dat)
il_dat_dedup <- il_dat[!duplicated(il_dat$Corporation.LLC.Name),]
il_dat_dedup$Corporation.LLC.Name[sapply(lapply(str_extract_all(tolower(il_dat_dedup$Corporation.LLC.Name), "\\w+"), function(x) str_detect(x, "^daughters$|^daughter$")), sum) > 0]
il_dat_dedup$Corporation.LLC.Name[sapply(lapply(str_extract_all(tolower(il_dat_dedup$Corporation.LLC.Name), "\\w+"), function(x) str_detect(x, "^sons$|^son$")), sum) > 0]
il_dat_dedup$Corporation.LLC.Name[sapply(lapply(str_extract_all(tolower(il_dat_dedup$Corporation.LLC.Name), "\\w+"), function(x) str_detect(x, "^sons$|^son$")), sum) > 0]
length(il_dat_dedup$Corporation.LLC.Name[sapply(lapply(str_extract_all(tolower(il_dat_dedup$Corporation.LLC.Name), "\\w+"), function(x) str_detect(x, "^sons$|^son$")), sum) > 0])
il_dat_dedup$Corporation.LLC.Name[sapply(lapply(str_extract_all(tolower(il_dat_dedup$Corporation.LLC.Name), "\\w+"), function(x) str_detect(x, "^daughters$|^daughter$")), sum) > 0]
ga_dat$Business.Name[sapply(lapply(str_extract_all(tolower(ga_dat$Business.Name), "\\w+"), function(x) str_detect(x, "^daughters$|^daughter$")), sum) > 0]
# Indiana
in_son <- read.csv("./in/in_son.csv", stringsAsFactors = FALSE)
in_daughter <- read.csv("./in/in_daughter.csv", stringsAsFactors = FALSE)
in_son$Business.Name
in_son$Business.Name[sapply(lapply(str_extract_all(tolower(in_son$Business.Name), "\\w+"), function(x) str_detect(x, "^sons$|^son$")), sum) > 0]
length(in_son$Business.Name[sapply(lapply(str_extract_all(tolower(in_son$Business.Name), "\\w+"), function(x) str_detect(x, "^sons$|^son$")), sum) > 0])
in_daughter$Business.Name
in_daughter$Business.Name[sapply(lapply(str_extract_all(tolower(in_daughter$Business.Name), "\\w+"), function(x) str_detect(x, "^daughters$|^daughter$")), sum) > 0]
in_daughter$Business.Name[sapply(lapply(str_extract_all(tolower(in_daughter$Business.Name), "\\w+"), function(x) str_detect(x, "^daughters$|^daughter$")), sum) == 0]
in_daughter$Business.Name[sapply(lapply(str_extract_all(tolower(in_daughter$Business.Name), "\\w+"), function(x) str_detect(x, "^daughters$|^daughter$")), sum) > 0]
4928/195
# Vermont
vt_son <- read.csv("vt/vt_son.csv", stringsAsFactors = FALSE)
View(vt_son)
vt_son$Business.Name[sapply(lapply(str_extract_all(tolower(vt_son$Business.Name), "\\w+"), function(x) str_detect(x, "^sons$|^son$")), sum) > 0]
length(vt_son$Business.Name[sapply(lapply(str_extract_all(tolower(vt_son$Business.Name), "\\w+"), function(x) str_detect(x, "^sons$|^son$")), sum) > 0])
vt_daughter <- read.csv("vt/vt_daughter.csv", stringsAsFactors = FALSE)
vt_daughter$Business.Name[sapply(lapply(str_extract_all(tolower(vt_daughter$Business.Name), "\\w+"), function(x) str_detect(x, "^daughter$|^daughters$")), sum) > 0]
1361/63
# Tennessee
tn_son <- read.csv("tn/tn_son.csv", stringsAsFactors = FALSE)
tn_son_dedup <- tn_son[!duplicated(tn_son$Control),]
tn_son_dedup$Name[sapply(lapply(str_extract_all(tolower(tn_son_dedup$Name), "\\w+"), function(x) str_detect(x, "^sons$|^son$")), sum) > 0]
tn_daughter <- read.csv("tn/tn_daughter.csv", stringsAsFactors = FALSE)
tn_daughter_dedup <- tn_daughter[!duplicated(tn_daughter$Control),]
tn_daughter_dedup$Name[sapply(lapply(str_extract_all(tolower(tn_daughter_dedup$Name), "\\w+"), function(x) str_detect(x, "^daughters$|^daughter$")), sum) > 0]
203/132
36233/250
res <- list()
for (i in 1:144) {
#https://www.sos.arkansas.gov/corps/search_corps.php
#href="search_corps.php?SEARCH=1&run=1&corp_type_id=&corp_name=men&agent_search=&agent_city=&agent_state=&filing_number=&cmd="
#https://www.sos.arkansas.gov/corps/search_corps.php?SEARCH=1&run=3&corp_type_id=&corp_name=men&agent_search=&agent_city=&agent_state=&filing_number=&cmd=
#https://www.sos.arkansas.gov/corps/search_corps.php?SEARCH=1&run=4&corp_type_id=&corp_name=men&agent_search=&agent_city=&agent_state=&filing_number=&cmd=
web_url <- paste0("https://www.sos.arkansas.gov/corps/search_corps.php?SEARCH=1&run=", i, "&corp_type_id=&corp_name=men&agent_search=&agent_city=&agent_state=&filing_number=&cmd=")
webpage <- read_html(web_url)
res <- rbind(res, html_table(webpage, fill = T)[[4]])
write_xml(webpage, file = paste0("data/ar/html_files/men_", i,".html"))
}
readr::write_csv(res, path = "data/ar/ar_men.csv")
res
setwd("C:\\Users\\wguil\\OneDrive\\Documents\\GitHub\\sonny_side\\data")
res <- list()
for (i in 1:144) {
#https://www.sos.arkansas.gov/corps/search_corps.php
#href="search_corps.php?SEARCH=1&run=1&corp_type_id=&corp_name=men&agent_search=&agent_city=&agent_state=&filing_number=&cmd="
#https://www.sos.arkansas.gov/corps/search_corps.php?SEARCH=1&run=3&corp_type_id=&corp_name=men&agent_search=&agent_city=&agent_state=&filing_number=&cmd=
#https://www.sos.arkansas.gov/corps/search_corps.php?SEARCH=1&run=4&corp_type_id=&corp_name=men&agent_search=&agent_city=&agent_state=&filing_number=&cmd=
web_url <- paste0("https://www.sos.arkansas.gov/corps/search_corps.php?SEARCH=1&run=", i, "&corp_type_id=&corp_name=men&agent_search=&agent_city=&agent_state=&filing_number=&cmd=")
webpage <- read_html(web_url)
res <- rbind(res, html_table(webpage, fill = T)[[4]])
write_xml(webpage, file = paste0("data/ar/html_files/men_", i,".html"))
}
readr::write_csv(res, path = "data/ar/ar_men.csv")
res <- list()
for (i in 1:144) {
#https://www.sos.arkansas.gov/corps/search_corps.php
#href="search_corps.php?SEARCH=1&run=1&corp_type_id=&corp_name=men&agent_search=&agent_city=&agent_state=&filing_number=&cmd="
#https://www.sos.arkansas.gov/corps/search_corps.php?SEARCH=1&run=3&corp_type_id=&corp_name=men&agent_search=&agent_city=&agent_state=&filing_number=&cmd=
#https://www.sos.arkansas.gov/corps/search_corps.php?SEARCH=1&run=4&corp_type_id=&corp_name=men&agent_search=&agent_city=&agent_state=&filing_number=&cmd=
web_url <- paste0("https://www.sos.arkansas.gov/corps/search_corps.php?SEARCH=1&run=", i, "&corp_type_id=&corp_name=men&agent_search=&agent_city=&agent_state=&filing_number=&cmd=")
webpage <- read_html(web_url)
res <- rbind(res, html_table(webpage, fill = T)[[4]])
write_xml(webpage, file = paste0("./ar/htm/men_", i,".html"))
}
res <- list()
for (i in 1:10) {
#https://www.sos.arkansas.gov/corps/search_corps.php
#href="search_corps.php?SEARCH=1&run=1&corp_type_id=&corp_name=men&agent_search=&agent_city=&agent_state=&filing_number=&cmd="
#https://www.sos.arkansas.gov/corps/search_corps.php?SEARCH=1&run=3&corp_type_id=&corp_name=men&agent_search=&agent_city=&agent_state=&filing_number=&cmd=
#https://www.sos.arkansas.gov/corps/search_corps.php?SEARCH=1&run=4&corp_type_id=&corp_name=men&agent_search=&agent_city=&agent_state=&filing_number=&cmd=
web_url <- paste0("https://www.sos.arkansas.gov/corps/search_corps.php?SEARCH=1&run=", i, "&corp_type_id=&corp_name=men&agent_search=&agent_city=&agent_state=&filing_number=&cmd=")
webpage <- read_html(web_url)
res <- rbind(res, html_table(webpage, fill = T)[[4]])
write_xml(webpage, file = paste0("./ar/htm/men_", i,".html"))
}
readr::write_csv(res, path = "./ar/ar_men.csv")
#Above works to scrape, now let's estimate ratio
ar_son <- read.csv("./ar/ar-son.csv", stringsAsFactors = FALSE)
#Above works to scrape, now let's estimate ratio
ar_son <- read.csv("./ar/ar_son.csv", stringsAsFactors = FALSE)
ar_daughter <- read.csv("./ar/ar_daughter.csv", stringsAsFactors = FALSE)
ar_daughter <- read.csv("./ar/ar-daughter.csv", stringsAsFactors = FALSE)
View(ar_son)
ar_son$X1[sapply(lapply(str_extract_all(tolower(ar_son$X1), "\\w+"), function(x) str_detect(x, "^son$|^sons$")), sum) > 0]
length(ar_son$X1[sapply(lapply(str_extract_all(tolower(ar_son$X1), "\\w+"), function(x) str_detect(x, "^son$|^sons$")), sum) > 0])
ar_daughter$Name
ar_daughter$Name[sapply(lapply(str_extract_all(tolower(ar_daughter$Name), "\\w+"), function(x) str_detect(x, "^daughter$|^daughters$")), sum) > 0]
res <- list()
for (i in 1:1) {
#web_url <- paste0("https://www.sos.arkansas.gov/corps/search_corps.php?SEARCH=1&run=", i, "&corp_type_id=&corp_name=son&agent_search=&agent_city=&agent_state=&filing_number=&cmd=")
web_url <- paste0("https://secure.utah.gov/bes/nameSearchResults.html?pageNo=", i)
webpage <- read_html(web_url)
res <- rbind(res, html_table(webpage, fill = T)[[4]])
write_xml(webpage, file = paste0("data/ar/html_files/son_", i,".html"))
}
res <- list()
for (i in 1:1) {
#web_url <- paste0("https://www.sos.arkansas.gov/corps/search_corps.php?SEARCH=1&run=", i, "&corp_type_id=&corp_name=son&agent_search=&agent_city=&agent_state=&filing_number=&cmd=")
web_url <- paste0("https://secure.utah.gov/bes/nameSearchResults.html?pageNo=", i)
webpage <- read_html(web_url)
res <- rbind(res, html_table(webpage, fill = T)[[5]])
write_xml(webpage, file = paste0("data/ar/html_files/son_", i,".html"))
}
?html_table
